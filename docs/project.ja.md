
# モダンファイルエクスプローラ開発計画 Nohr

## 1. 概要

macOS 標準の Finder に代わる、高速・柔軟・拡張可能なファイルエクスプローラを Rust と gpui で開発する。目的は「日常的に使いたくなる快適さ」と「開発者・パワーユーザー向けの機能性」の両立である。

---

## 2. 開発の目的

- Finder の操作性や拡張性の限界を超え、軽快かつ直感的な UI を実現する。

- モダンデザインを重要視する。

- 大規模ディレクトリ、リモートストレージ、Git 連携を統合管理できるワークスペースを提供。

- ローカル・クラウド・コードリポジトリを横断する統一的ファイル操作体験を構築する。

---

## 3. 想定ユーザー

- 開発者（Rust / Go / Python などを使用するプログラマ）

- デザイナーやリサーチャー（多種ファイルを整理するユーザー）

- クラウド利用者（S3互換ストレージを日常的に使用）

- ターミナル操作に慣れているパワーユーザー


---

## 4. 主要機能

### 4.1 ナビゲーション・UI

- **タブ & スプリットビュー**：複数ディレクトリを並列操作。

- **インラインプレビュー**：画像・PDF・テキスト・Markdown を即表示。

- **コマンドパレット**：全機能を検索して実行（VSCode風）。

- **ファイル絵文字**：タイプ別・ユーザー定義ラベル対応（視認性向上）。


### 4.2 ファイル操作

- **インプレース編集**：`.txt`, `.md` を作成・即時編集・保存。

- **バルクリネーム**：正規表現、メタデータ駆動の一括変更。

- **ドラッグ＆ドロップ拡張**：S3アップロードや Git ステージングを統合。

- **クリップボード履歴**：複数ファイルのコピー履歴管理。


### 4.3 検索・インデックス

- **超高速全文検索**：tantivy + ripgrep によるインクリメンタル検索。あいまい検索

- **スマートフォルダ**：タグ・拡張子・日付で動的にフィルタ。

- **プレビュー内検索**：PDF・Markdown・コードも対象。


### 4.4 ターミナル統合

- **組み込みPTY**：カレントディレクトリ連動シェル。

- **ファイルドラッグで自動エスケープ貼り付け**。

- **タスクランナー**：任意コマンドのワンクリック実行。


### 4.5 Git連携

- **サイドバーでステータス・ブランチ確認**

- **差分プレビュー & ブレーム表示**

- **マージコンフリクト解消UI**


### 4.6 S3互換ストレージ連携

- **MinIO / Wasabi / Cloudflare R2 対応**

- **転送キュー & 並列アップロード**

- **メタデータ編集・プリサインURL生成**

- **オフラインキャッシュと同期復旧**


### 4.7 自動化・拡張

- **WASMプラグイン機構**（UI/機能拡張）

- **フォルダ監視アクション**（条件に応じて自動タグ付け・転送）

- **CLI/HTTP API**：外部から操作可能。


---

## 5. 開発技術スタック

| 項目       | 使用技術                        |
| -------- | --------------------------- |
| 言語       | Rust                        |
| UI       | gpui                        |
| 検索       | tantivy / ripgrep           |
| Git      | git2 / gix                  |
| ストレージ    | aws-sdk-rust / object_store |
| Markdown | comrak + syntect            |
| データ管理    | sled / SQLite               |
| 監視       | notify                      |
| 並列処理     | tokio / rayon               |

---

## 6. UI設計コンセプト

- **即応性**：大規模フォルダでも遅延読み込みで高速描画。

- **一貫性**：キーバインドと動作をVSCodeやTerminalと揃える。

- **可視性**：絵文字・タグ・色による情報密度の最適化。
	- 白黒ベースで見やすく、モダンなデザイン。

- **拡張性**：プラグイン/スクリプトでの機能追加を前提。


---

## 7. セキュリティ設計

- macOS Keychain で資格情報を安全保存。

- フルディスクアクセス権検出と自動設定支援。

- ファイル削除の取り消し・履歴復元。

- 外部API通信の署名・認可管理。


---

## 8. 競合比較（Finder, ForkLift, Commander One 等）

|機能|Finder|ForkLift|本アプリ|
|---|---|---|---|
|S3対応|×|○|◎（統合的）|
|Git統合|×|△|◎|
|Markdown編集|×|×|◎|
|ターミナル連携|×|△|◎|
|プラグイン拡張|×|×|◎|
|自動化/監視|×|×|○|

